<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Learning C# Programming</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  </head>
  <body class="container mt-4">
    <h1>Chapter 24: Test-Driving AutoLot</h1>
    <p>In this chapter, we'll test the AutoLot data access layer using xUnit, a testing framework for .NET Core. We'll create and run automated tests to ensure our code works correctly.</p>

    <h2>Setting Up the Tests</h2>
    <p>Instead of creating a client application, we'll use automated integration tests to test the database operations (create, read, update, delete).</p>

    <h3>Steps to Set Up:</h3>
    <ol>
      <li><strong>Create the Project</strong>: Use xUnit for testing. Add necessary NuGet packages. Add project references to AutoLot.Models and AutoLot.Dal.</li>
      <li><strong>Add Global Usings</strong>: Create a <code>GlobalUsings.cs</code> file for all using statements.</li>
      <li><strong>Configure the Project</strong>: Add a JSON file for configuration. Create helper classes for configuration and database context.</li>
    </ol>

    <h2>Writing Tests with xUnit</h2>
    <p>xUnit has two types of tests:</p>
    <ul>
      <li><strong>Fact</strong>: Tests without parameters.</li>
      <li><strong>Theory</strong>: Tests with parameters.</li>
    </ul>

    <h3>Example:</h3>
    <pre><code>
[Fact]
public void SimpleFactTest() {
    Assert.Equal(5, 3 + 2);
}

[Theory]
[InlineData(3, 2, 5)]
[InlineData(1, -1, 0)]
public void SimpleTheoryTest(int a, int b, int expected) {
    Assert.Equal(expected, a + b);
}
    </code></pre>

    <h2>Running Tests</h2>
    <p>You can run tests using Visual Studio's Test Explorer or the command line (<code>dotnet test</code>).</p>

    <h2>Creating Integration Tests</h2>
    <p>Integration tests check the entire flow from code to database and back.</p>

    <h3>Example:</h3>
    <ol>
      <li><strong>Setup</strong>: Create a base test class to handle configuration and database context.</li>
      <li><strong>Test Execution</strong>: Use transactions to ensure the database state remains unchanged after tests.</li>
    </ol>

    <h2>Querying the Database</h2>
    <p>Use LINQ or raw SQL to query the database.</p>

    <h3>Example:</h3>
    <pre><code>
[Fact]
public void ShouldGetAllCustomers() {
    var customers = Context.Customers.ToList();
    Assert.Equal(5, customers.Count);
}
    </code></pre>

    <h2>Exercises</h2>

    <h3>Exercise 1: Create a Simple Test</h3>
    <p><strong>Task</strong>: Write a test to check if 2 + 2 equals 4.</p>
    <p><strong>Pseudocode Hint</strong>:</p>
    <pre><code>
function testAddition() {
    assert(2 + 2 == 4)
}
    </code></pre>

    <h3>Exercise 2: Query the Database</h3>
    <p><strong>Task</strong>: Write a test to get all cars from the database.</p>
    <p><strong>Pseudocode Hint</strong>:</p>
    <pre><code>
function testGetAllCars() {
    cars = queryDatabase("SELECT * FROM Cars")
    assert(cars.length > 0)
}
    </code></pre>

    <h3>Exercise 3: Add a New Car</h3>
    <p><strong>Task</strong>: Write a test to add a new car to the database.</p>
    <p><strong>Pseudocode Hint</strong>:</p>
    <pre><code>
function testAddCar() {
    car = createCar("Red", "Toyota", "Corolla")
    addCarToDatabase(car)
    assert(car.id != null)
}
    </code></pre>

    <h3>Exercise 4: Update a Car</h3>
    <p><strong>Task</strong>: Write a test to update a car's color.</p>
    <p><strong>Pseudocode Hint</strong>:</p>
    <pre><code>
function testUpdateCar() {
    car = getCarById(1)
    car.color = "Blue"
    updateCarInDatabase(car)
    updatedCar = getCarById(1)
    assert(updatedCar.color == "Blue")
}
    </code></pre>

    <h3>Exercise 5: Delete a Car</h3>
    <p><strong>Task</strong>: Write a test to delete a car from the database.</p>
    <p><strong>Pseudocode Hint</strong>:</p>
    <pre><code>
function testDeleteCar() {
    car = getCarById(1)
    deleteCarFromDatabase(car)
    deletedCar = getCarById(1)
    assert(deletedCar == null)
}
    </code></pre>

    <footer class="mt-4">
      <nav aria-label="Page navigation example">
        <ul class="pagination justify-content-center">
          <li class="page-item">
            <a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p23.html">Previous</a>
          </li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/index.html">1</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p2.html">2</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p3.html">3</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p4.html">4</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p5.html">5</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p6.html">6</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p7.html">7</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p8.html">8</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p9.html">9</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p10.html">10</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p11.html">11</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p12.html">12</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p13.html">13</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p14.html">14</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p15.html">15</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p16.html">16</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p17.html">17</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p18.html">18</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p19.html">19</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p20.html">20</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p21.html">21</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p22.html">22</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p23.html">23</a></li>
          <li class="page-item active" aria-current="page"><a class="page-link" href="#">24</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p25.html">25</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p26.html">26</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p27.html">27</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p28.html">28</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p29.html">29</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p30.html">30</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p31.html">31</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p32.html">32</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p33.html">33</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p34.html">34</a></li>
          <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p25.html">Next</a></li>
              </ul>
          </nav>
        </footer>
    
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+o2e40pHs2b8pfp1HgpKFO4ZzR0J" crossorigin="anonymous"></script>
      </body>