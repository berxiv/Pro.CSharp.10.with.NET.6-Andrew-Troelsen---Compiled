<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Learning C# Programming</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  </head>
  <body class="container mt-4">
    <h1>Chapter 23: Build a Data Access Layer with Entity Framework Core</h1>
    <p>In this chapter, we'll learn how to use Entity Framework Core (EF Core) to build a data access layer for the AutoLot database. We'll create two projects: one for the entities (models) and another for the data access code. We'll start by scaffolding the existing database into entities and a DbContext, then switch to a code-first approach. Finally, we'll create repositories for CRUD operations and add sample data for testing.</p>

    <h2>Step 1: Create Projects</h2>
    <ol>
      <li>Create a new solution named <code>Chapter23_AllProjects</code>.</li>
      <li>Add a .NET Core class library named <code>AutoLot.Models</code> for the entities.</li>
      <li>Add another .NET Core class library named <code>AutoLot.Dal</code> for the data access code.</li>
    </ol>

    <h2>Step 2: Add NuGet Packages</h2>
    <p>Add the following NuGet packages to both projects:</p>
    <ul>
      <li><code>Microsoft.EntityFrameworkCore</code></li>
      <li><code>Microsoft.EntityFrameworkCore.SqlServer</code></li>
      <li><code>System.Text.Json</code></li>
    </ul>

    <h2>Step 3: Scaffold the Database</h2>
    <p>Use the EF Core CLI to scaffold the database into entities and a DbContext:</p>
    <pre><code>dotnet ef dbcontext scaffold "your_connection_string" Microsoft.EntityFrameworkCore.SqlServer --data-annotations --context ApplicationDbContext --context-namespace AutoLot.Dal.EfStructures --context-dir EfStructures --no-onconfiguring --namespace AutoLot.Models.Entities --output-dir ..\AutoLot.Models\Entities --force</code></pre>

    <h2>Step 4: Update Entities</h2>
    <p>Update the scaffolded entities to their final versions. For example, rename <code>Inventory</code> to <code>Car</code> and add necessary attributes.</p>

    <h2>Step 5: Create Repositories</h2>
    <p>Create repositories to handle CRUD operations. For example, create a <code>CarRepo</code> for the <code>Car</code> entity.</p>

    <h2>Step 6: Add Sample Data</h2>
    <p>Create a class to initialize the database with sample data for testing.</p>

    <h2>Exercises</h2>
    <h3>Exercise 1: Create a New Entity</h3>
    <p><strong>Task:</strong> Create a new entity named <code>Driver</code> with properties <code>FirstName</code> and <code>LastName</code>.</p>
    <pre><code>public class Driver
{
    public int Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
}</code></pre>

    <h3>Exercise 2: Scaffold the Database</h3>
    <p><strong>Task:</strong> Scaffold the database using EF Core CLI.</p>
    <pre><code>dotnet ef dbcontext scaffold "your_connection_string" Microsoft.EntityFrameworkCore.SqlServer --data-annotations --context ApplicationDbContext --context-namespace YourNamespace --context-dir YourDirectory --no-onconfiguring --namespace YourNamespace.Entities --output-dir ..\YourNamespace\Entities --force</code></pre>

    <h3>Exercise 3: Create a Repository</h3>
    <p><strong>Task:</strong> Create a repository for the <code>Driver</code> entity.</p>
    <pre><code>public class DriverRepo : BaseRepo<Driver>
{
    public DriverRepo(ApplicationDbContext context) : base(context) { }
}</code></pre>

    <h3>Exercise 4: Add Sample Data</h3>
    <p><strong>Task:</strong> Add sample data for the <code>Driver</code> entity.</p>
    <pre><code>public static List<Driver> Drivers => new()
{
    new Driver { FirstName = "John", LastName = "Doe" },
    new Driver { FirstName = "Jane", LastName = "Smith" }
};</code></pre>

<footer class="mt-4">
  <nav aria-label="Page navigation example">
    <ul class="pagination justify-content-center">
      <li class="page-item">
        <a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p22.html">Previous</a>
      </li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/index.html">1</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p2.html">2</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p3.html">3</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p4.html">4</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p5.html">5</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p6.html">6</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p7.html">7</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p8.html">8</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p9.html">9</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p10.html">10</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p11.html">11</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p12.html">12</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p13.html">13</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p14.html">14</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p15.html">15</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p16.html">16</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p17.html">17</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p18.html">18</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p19.html">19</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p20.html">20</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p21.html">21</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p22.html">22</a></li>
      <li class="page-item active" aria-current="page"><a class="page-link" href="#">23</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p24.html">24</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p25.html">25</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p26.html">26</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p27.html">27</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p28.html">28</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p29.html">29</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p30.html">30</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p31.html">31</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p32.html">32</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p33.html">33</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p34.html">34</a></li>
      <li class="page-item"><a class="page-link" href="file:///C:/Users/allan/Desktop/c%23learningwebsite/p24.html">Next</a></li>
          </ul>
      </nav>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+o2e40pHs2b8pfp1HgpKFO4ZzR0J" crossorigin="anonymous"></script>
  </body>